<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <input type="button" value="눌러" id="id_btn">
    <script>
        var v_btn = document.getElementById("id_btn");
        v_btn.onclick = function () {
            var v_xhr = new XMLHttpRequest();
            v_xhr.open("get", "https://api.exchangeratesapi.io/history?start_at=2020-01-01&end_at=2020-01-31", true);
            v_xhr.send();

            v_xhr.onreadystatechange = function () {
                if (v_xhr.readyState == 4 && v_xhr.status == 200) {
                    var v_data = JSON.parse(v_xhr.responseText);
                    var v_rates = v_data.rates;
                    var v_arr = [];
                    // 객체 속성 수 만큼 loop 돌리기, for in 문
                    for (var v_attr in v_rates) { // for in 문을 쓰면 순서가 보장되지 않기 때문에 뒤죽박죽으로 나옴
                        var v_str = {};
                        v_str[v_attr] = {}
                        v_str[v_attr].KRW = v_rates[v_attr].KRW;
                        v_str[v_attr].JPY = v_rates[v_attr].JPY;
                        // console.log(v_str)

                        // console.log(v_attr);
                        // console.log("1달러당 " + v_rates[v_attr].KRW + "원");
                        // console.log("1달러당 " + v_rates[v_attr].JPY + "엔");
                        // console.log("=====================")
                        v_arr.push(v_str);
                    }
                    for (var i = 0; i < v_arr.length; i++) {
                        JSON.stringify(v_arr[i]).replace("-", "");
                        console.log(JSON.stringify(v_arr[i]).replace("-", ""));
                    }
                    // var v_a = localStorage.getItem("저장");
                    // console.log(localStorage.getItem("저장"))

                    // console.log(JSON.parse(v_a)[0]);
                    // 오늘의 과제: 배열 날짜순 정렬
                    // v_arr.mySort = function (f_callback) {
                    //     for (var i = 0; i < this.length; i++) {
                    //         for (var j = i + 1; j < this.length; j++) {
                    //             if (f_callback(this[i], this[j]) < 0) {
                    //                 var v_temp = this[i];
                    //                 this[i] = this[j];
                    //                 this[j] = v_temp;
                    //             }
                    //         }
                    //     }
                    // }

                    // v_arr.mysort(function (a, b) {
                    //     console.log(a);
                    //     console.log(b);
                    //     console.log("=================")
                    //     return a - b;
                    // });

                    localStorage.setItem("저장", JSON.stringify(v_arr));
                    // KRW와 JPY 값만 날짜별로 빼서 localStorage 저장
                    // [
                    //     {
                    //         "날짜": {
                    //             "KRW": 값,
                    //             "JPY": 값
                    //         }
                    //     },

                    //     { ...},


                    // ]
                }
            }
        }
    </script>
</body>

</html>